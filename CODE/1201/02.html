<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>영화 검색 앱</title>

    <style>
      body {
        font-family: "Pretendard", sans-serif;
        margin: 0;
        background-color: #f4f4f4;
      }

      /* 상단 배너 */
      .hero {
        background-color: black;
        padding: 80px 20px;
        color: white;
      }

      .hero h1 {
        font-size: 40px;
        margin-bottom: 10px;
      }

      .search-box {
        max-width: 600px;
        margin-top: 20px;
        display: flex;
        gap: 10px;
      }

      .search-box input {
        flex: 1;
        padding: 12px;
        border-radius: 30px;
        border: none;
        font-size: 16px;
      }

      .search-box button {
        padding: 12px 20px;
        border-radius: 30px;
        border: none;
        background: linear-gradient(to right, #4bd2c6, #63e6be);
        color: white;
        font-weight: bold;
        cursor: pointer;
      }

      /* 섹션 제목 */
      h2 {
        margin-left: 20px;
      }

      /* 영화 카드 목록 */
      .movie-list {
        display: flex;
        overflow-x: auto;
        gap: 20px;
        padding: 20px;
      }

      .movie-card {
        min-width: 150px;
        background: white;
        border-radius: 12px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        cursor: pointer;
        overflow: hidden;
      }

      .movie-card img {
        width: 100%;
        border-bottom: 1px solid #ddd;
      }

      .movie-card p {
        margin: 10px;
        font-size: 14px;
        font-weight: bold;
      }

      /* 상세 페이지 */
      .detail-page {
        display: none;
        padding: 20px;
      }

      .detail-page img {
        width: 150px;
        border-radius: 10px;
      }

      .back-btn {
        margin-bottom: 20px;
        padding: 10px 20px;
        background: black;
        color: white;
        width: 120px;
        border: none;
        cursor: pointer;
        border-radius: 8px;
      }
    </style>
  </head>

  <body>
    <!-- ⭐ 상단 배너 -->
    <div class="hero">
      <h1>환영합니다</h1>
      <p>수백만 개의 영화, TV 프로그램 및 인물을 발견하세요.</p>

      <!-- ⭐ 검색창 -->
      <div class="search-box">
        <input id="searchInput" type="text" placeholder="영화 제목을 입력하세요." />
        <button id="searchBtn">검색</button>
      </div>
    </div>

    <!-- ⭐ 인기 영화 영역 -->
    <h2>인기 영화</h2>
    <div id="popularMovies" class="movie-list"></div>

    <!-- ⭐ 검색 결과 / 상세 페이지 전환 화면 -->
    <div id="detailPage" class="detail-page"></div>

    <script>
      const BASE_URL = "https://api.themoviedb.org/3";
      const API_KEY = "d40653d9f45c0c0a68900733a9c2b6e7";
      const IMG_URL = "https://image.tmdb.org/t/p/w500";

      const popularContainer = document.getElementById("popularMovies");
      const detailPage = document.getElementById("detailPage");

      /* ============================
         ⭐ 인기 영화 가져오기
      ============================ */
      async function loadPopularMovies() {
        const res = await fetch(
          `${BASE_URL}/movie/popular?api_key=${API_KEY}&language=ko-KR&page=1`
        );
        const data = await res.json();
        renderMovieList(data.results);
      }

      /* ============================
         ⭐ 영화 카드 목록 출력
      ============================ */
      function renderMovieList(movies) {
        popularContainer.innerHTML = "";

        movies.forEach((movie) => {
          const card = document.createElement("div");
          card.classList.add("movie-card");
          card.onclick = () => loadMovieDetail(movie.id); // 카드 클릭 → 상세 페이지

          card.innerHTML = `
            <img src="${IMG_URL}${movie.poster_path}" />
            <p>${movie.title}</p>
          `;
          popularContainer.appendChild(card);
        });
      }

      /* ============================
         ⭐ 영화 상세 정보 가져오기
      ============================ */
      async function loadMovieDetail(id) {
        const res = await fetch(
          `${BASE_URL}/movie/${id}?api_key=${API_KEY}&language=ko-KR`
        );
        const movie = await res.json();
        showDetailPage(movie);
      }

      /* ============================
         ⭐ 상세 페이지 렌더링
      ============================ */
      function showDetailPage(movie) {
        detailPage.style.display = "block";
        document.querySelector(".hero").style.display = "none";
        document.querySelector("h2").style.display = "none";
        popularContainer.style.display = "none";

        detailPage.innerHTML = `
          <button class="back-btn" onclick="goBack()">← 뒤로가기</button>
          <h1>${movie.title}</h1>
          <img src="${IMG_URL}${movie.poster_path}" />
          <p><strong>평점:</strong> ${movie.vote_average}</p>
          <p><strong>줄거리:</strong> ${movie.overview}</p>
        `;
      }

      /* ============================
         ⭐ 뒤로 가기
      ============================ */
      function goBack() {
        detailPage.style.display = "none";
        document.querySelector(".hero").style.display = "block";
        document.querySelector("h2").style.display = "block";
        popularContainer.style.display = "flex";
      }

      /* ============================
         ⭐ 검색 기능
      ============================ */
      document.getElementById("searchBtn").addEventListener("click", async () => {
        const query = document.getElementById("searchInput").value;
        if (!query) return alert("검색어를 입력하세요!");

        const res = await fetch(
          `${BASE_URL}/search/movie?api_key=${API_KEY}&language=ko-KR&query=${query}`
        );
        const data = await res.json();

        if (data.results.length === 0) {
          alert("검색 결과가 없습니다!");
          return;
        }

        // 첫 번째 검색 결과의 상세 페이지로 이동
        loadMovieDetail(data.results[0].id);
      });

      // 실행 시 인기 영화 로드
      loadPopularMovies();
    </script>
  </body>
</html>
